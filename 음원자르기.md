# ✂️ 음원 자르기 도구 사용 설명서 (처음 사용자용 / 완전 상세)

이 문서는 **처음 사용하는 사람도 한 번에** 사용할 수 있도록,  
프로그램의 **화면에 보이는 기능** 기준으로 “사소한 것까지” 전부 정리한 매뉴얼입니다.

---

## 0) 이 도구로 할 수 있는 것 (한 줄 요약)

- `음원 정보`에 있는 **유튜브 링크 + 구간(시작/끝)** 정보를 기반으로
- 유튜브에서 음원을 가져와서
- 지정한 구간만큼 **잘라서 저장**(MP3/OGG/WAV)
- 그리고 저장된 파일을 **번호와 제목 규칙**으로 정리해 폴더에 모아두는 도구입니다.

추가로:
- 음원 정보를 **표 형태로 입력/수정**할 수 있고
- 입력된 정보와 실제 잘린 파일이 **정상인지 검사**할 수도 있습니다.

---

## 1) 미리 준비해야 할 것 (들어있는 채로 배포됩니다)

### 1-1. 필수 파일
프로그램 폴더 기준으로 아래가 존재해야 합니다.

- `res/yt-dlp.exe`  
  → 유튜브에서 스트림 주소를 가져오는 도구

- `res/ffmpeg/bin/ffmpeg.exe`  
  → 실제로 자르기/인코딩/볼륨 적용을 하는 도구

> 만약 이 파일들이 없으면 “찾을 수 없다”는 오류가 뜨거나 기능이 동작하지 않습니다.

### 1-2. 저장되는 폴더
잘린 파일은 자동으로 아래 폴더에 저장됩니다.

- `sound/mp3`
- `sound/ogg`
- `sound/wav`

폴더가 없으면 자동으로 만들어집니다.

---

## 2) 화면 구성 설명 (처음 실행했을 때)

창 제목: **“음원 자르기”**

### 2-1. 출력 포맷 영역
- `MP3 (추천)` (기본 선택)
- `OGG`
- `WAV`

✅ **중요:** 동시에 여러 개 선택이 안 됩니다.  
한 번에 **한 가지 포맷만** 선택됩니다.

### 2-2. 자르기 설정 영역
입력칸 3개가 있습니다.

- **시작 번호**
- **끝 번호**
- **볼륨 (14 권장)**

### 2-3. 메인 버튼 3개
- **자르기**
- **음원 정보 검사**

### 2-4. 좌측 하단 작은 버튼들
- **FAQ**
- **도움말**
- **(현재 확장자) 파일 열기**  
  예: `(mp3) 파일 열기`

---

## 3) 가장 빠른 사용 순서 (처음이라면 이대로)

### 목표: “음원 정보에 적힌 1번~10번을 MP3로 잘라 저장”
1. **우측 표**를 확인합니다.
2. 표에서 1~10행에 대해:
   - 노래 이름
   - 시작 시간
   - 종료 시간
   - 유튜브 링크  
   를 채웁니다.
3. 메인 창으로 돌아와서
   - 출력 포맷을 `MP3 (추천)`으로 둡니다.
4. **시작 번호**에 `1`, **끝 번호**에 `10` 입력
5. **볼륨**은 기본 `14` 유지
6. **자르기** 클릭
7. “설정 확인” 창이 나오면 내용을 확인하고 **예**를 누릅니다.
8. 진행 창에서 각 항목이 “완료”로 바뀌는지 확인합니다.
9. 끝나면 요약 창이 뜨고, 저장 폴더에 파일이 생성됩니다.
   - `(mp3) 파일 열기` 버튼을 눌러 바로 확인할 수 있습니다.

---

## 4) 출력 포맷(확장자) 선택 규칙

### 4-1. MP3 / OGG / WAV 선택
- 체크박스로 보이지만 실제 동작은 “라디오 버튼”처럼 **하나만 선택**됩니다.
- 아무것도 선택 안 된 상태가 되려고 하면 자동으로 다시 하나가 켜집니다.  
  → 즉, **항상 최소 1개는 선택 상태**가 유지됩니다.

### 4-2. 선택한 포맷에 따라 저장 경로가 달라짐
예를 들어 OGG를 선택하면:
- 저장 위치: `sound/ogg`
- 하단 버튼도 `(ogg) 파일 열기`로 바뀝니다.

---

## 5) “시작 번호 / 끝 번호”란?

### 5-1. 번호의 의미
- “음원 정보 입력” 표에서의 **행 번호(인덱스)** 입니다.
- 번호는 `0`부터 시작합니다.
  - `0`은 표에서 “0 (오프닝)”으로 표시됩니다.

### 5-2. 자르기 범위 규칙
- 시작 번호 ≤ 끝 번호 여야 합니다.
- 음수 불가 (0 이상만 가능)

예:
- `시작 5`, `끝 5` → 5번 **한 곡만** 자르기
- `시작 3`, `끝 8` → 3~8번까지 **연속으로** 자르기

---

## 6) 볼륨(14 권장) 규칙 (엄청 중요)

- **숫자만 입력 가능합니다.**  
  문자 입력은 막힙니다.

### 6-1. 허용 범위
- 0 ~ 40 사이
- 40을 초과하면 오류로 진행 불가

### 6-2. 14 기준 경고
- 14보다 낮거나 높으면 경고창이 뜹니다:
  - “권장치보다 낮습니다/높습니다. 계속하시겠습니까?”
- 여기서 **아니오**를 누르면 자르기가 시작되지 않습니다.

---

## 7) 자르기 실행 과정 (버튼: “자르기”)

### 7-1. 자르기 시작 전 확인되는 것
자르기를 누르면 다음을 먼저 확인합니다:

1) 시작/끝/볼륨이 숫자인지  
2) 번호가 0 이상인지  
3) 끝 번호가 시작 번호보다 작지 않은지  
4) 볼륨이 40 이하인지  
5) 시작 행과 끝 행의 **노래 이름이 비어있지 않은지**

하나라도 실패하면 메시지가 나오고 멈춥니다.

### 7-2. 확인 팝업(예/아니오)
정상이라면 “확인” 창이 뜹니다. 표시 내용:
- 파일형식 (MP3/OGG/WAV)
- 시작 노래(시작 번호의 제목)
- 끝 노래(끝 번호의 제목)
- 음량 (볼륨 값, dB)

여기서 **예**를 눌러야 실제 자르기가 시작됩니다.

---

## 8) 진행 창(자르기 진행 중...) 사용법

자르기를 시작하면 별도 창이 뜹니다.

### 8-1. 진행 창 구성
- 상단: 현재 작업 상태(퍼센트/제목)
- 중간: 리스트(각 행의 진행 상태)
- 하단: **취소** 버튼

✅ 이 창은 작업 중에는 X로 닫을 수 없습니다.  
닫으려고 하면 경고가 뜨고 닫히지 않습니다.

### 8-2. 항목 상태가 바뀌는 흐름
각 행은 대략 이렇게 바뀝니다:
- “준비 중...”
- “길이 계산 중...”
- “자르는 중... (xx%)”
- “자르기 완료”
- 또는 “자르기 실패: (이유)”

### 8-3. 실패가 나는 대표적인 원인
- 제목/시작/종료/링크 중 하나라도 빈칸
- 시작 시간이 종료 시간보다 같거나 큼
- 유튜브 스트림 주소를 가져오지 못함
- FFmpeg 실행 실패(경로/파일 문제)
- 링크가 잘못됐거나 접근 불가 영상

---

## 9) 취소 버튼 동작 (중요)

진행 창에서 **취소**를 누르면:

- “취소 요청됨. 현재 작업 종료 후 중지됩니다.” 라고 표시됩니다.
- 즉시 멈추는 게 아니라, **현재 처리 중인 항목이 끝난 후** 멈춥니다.
- 취소 버튼은 한 번 누르면 비활성화됩니다(중복 클릭 방지).

---

## 10) 자르기 결과 요약 창

작업이 끝나면 진행 창이 숨겨지고, **“자르기 결과 요약”** 창이 뜹니다.

요약 창에는:
- ❌ 실패 항목 목록
- ✅ 성공 항목 목록(“완료”라는 단어가 들어간 항목만 성공으로 분류)
- 취소되었으면 “중간에 취소됨” 경고

요약 창을 닫아야 진행 창이 완전히 종료됩니다.

---

## 11) 저장되는 파일 이름 규칙 (매우 중요)

저장 파일명 기본 형태:

- `번호. 제목.확장자`

예:
- `12. MySong.mp3`

### 11-1. 파일명에 사용할 수 없는 문자는 자동으로 변경됨
제목에 Windows 파일명 금지 문자가 있으면 `_`로 바뀝니다.

### 11-2. 같은 파일명이 이미 있으면 자동으로 뒤에 번호가 붙음
이미 파일이 있으면 이런 식으로 저장될 수 있습니다:
- `12_1. 제목.mp3`
- `12_2. 제목.mp3`

---

## 12) “(확장자) 파일 열기” 버튼

하단의 예: `(mp3) 파일 열기`

- 현재 선택된 출력 포맷에 맞는 폴더를 엽니다.
- 폴더가 없으면 자동 생성 후 열립니다.

예:
- MP3 선택 시 → `sound/mp3`
- OGG 선택 시 → `sound/ogg`

---

## 13) 음원 정보 입력(표 편집) 기능

이 기능은 `음원 정보`를 **엑셀 같은 표**로 편집하는 도구입니다.

### 13-1. 표의 열(컬럼) 의미
- **번호**: 자동 표시(편집 불가)
- **노래 이름**
- **시작 시간**
- **종료 시간**
- **YouTube 링크**

### 13-2. 저장 방식
- 표를 편집할 때마다 즉시 반영됩니다.
- 창을 닫을 때도 전체 저장을 다시 합니다.

---

## 14) 표 편집 규칙 (시간/링크/제목 자동 보정)

### 14-1. 시작 시간 / 종료 시간 입력 규칙
입력 허용 형태:
- `mm:ss` (예: `1:05`, `12:34`)

자동으로 `:`로 바꿔주는 입력:
- `.` `;` `-` `/` 등으로 구분해도 `:`로 처리될 수 있음
- 숫자만 입력하면 자동 변환될 수 있음:
  - `105` → `1:05`
  - `1234` → `12:34`

❌ 불가능한 경우(입력 즉시 경고 후 빈칸 처리):
- mm 또는 ss가 0~59 범위를 벗어남
- 형식이 `mm:ss`가 아님

✅ 추가 규칙:
- 시작 시간은 종료 시간보다 **반드시 작아야** 합니다.
- 같거나 크면 “시간 순서 오류”가 뜨고 값이 지워집니다.

### 14-2. YouTube 링크 입력 규칙
- 유효한 영상 링크면 자동으로 표준 형태로 정리될 수 있습니다.
- 유효하지 않으면 “유효하지 않은 YouTube 링크” 경고 후 빈칸 처리됩니다.

#### 재생목록 링크를 넣었을 때(중요)
- 링크에 `list=`가 있고 영상 ID가 없는 형태라면,
  해당 재생목록을 분석해서 여러 행에 자동으로 채울 수 있습니다.
- 이때 필요한 프로그램이 없거나 실패하면 오류가 뜰 수 있습니다.

### 14-3. 노래 이름(제목) 입력 규칙
- 제목에 특수문자가 있으면 자동 제거될 수 있습니다.
- 제거되면 “자동 수정됨” 안내가 나오며 어떤 문자가 제거됐는지 알려줍니다.

---

## 15) 표 우클릭 메뉴(컨텍스트 메뉴) 기능 설명

표에서 우클릭하면 메뉴가 뜹니다.

### 15-1. Undo / Redo
- `Undo` (Ctrl + Z)
- `Redo` (Ctrl + Y)

여러 셀을 한 번에 지우거나 붙여넣는 동작도 “한 번의 작업”으로 되돌릴 수 있습니다.

### 15-2. 링크 중복 표시
- 켜면: 같은 유튜브 영상이 여러 줄에 있으면 색으로 구분해 강조 표시합니다.
- 끄면: 강조가 해제됩니다.

> 이 기능은 중복을 “삭제”하지 않습니다.  
> 단지 “보이게 표시”만 합니다.

### 15-3. 행 삭제
- 우클릭한 행을 삭제합니다.
- 삭제 후 번호는 자동으로 다시 정리됩니다.
- 입력 값이 남아있는 마지막 행을 삭제할 때는 확인 메시지가 뜰 수 있습니다.

### 15-4. 행 추가
- 현재 선택 위치 기준으로 **다음 행에 빈 행을 삽입**합니다.
- 새로 생긴 행은 값이 모두 빈칸입니다.

### 15-5. 링크 열기 / 링크 열기(시작시간)
- 기본: 브라우저로 유튜브 링크를 엽니다.
- 시작시간: 시작 시간이 있는 행이면 그 시점부터 재생되도록 열 수 있습니다.
  - 시작 시간이 비어있으면 0초부터 열립니다.

### 15-6. 자르기 (표에서 바로 실행)
- 표에서 여러 행을 선택하고 “자르기”를 누르면:
  - 선택한 행의 **최소 행 번호 ~ 최대 행 번호** 범위로
  - 메인 창의 시작/끝 번호가 자동으로 들어가고
  - 바로 자르기가 실행됩니다.

### 15-7. 선택된 값만 삭제
- 선택된 셀(번호 열 제외)만 빈칸으로 만듭니다.
- 여러 셀 선택 상태를 유지하면서 한 번에 지울 수 있습니다.

### 15-8. 전체 삭제
- 번호 열을 제외한 값들을 전체 빈칸으로 만듭니다.
- 실행 전 “정말 삭제?” 확인이 뜹니다.

---

## 16) 표 단축키 모음 (입력창에서)

- `Ctrl + C` : 복사
- `Ctrl + X` : 잘라내기(복사 + 선택 셀 비우기)
- `Ctrl + V` : 붙여넣기(탭/줄바꿈 기반으로 여러 셀 채움)
- `Delete` / `Backspace` : 선택 셀 비우기
- `Ctrl + Z` : Undo
- `Ctrl + Y` : Redo
- `Ctrl + F` : 검색 입력칸으로 포커스 이동

---

## 17) 표 검색 기능(검색칸)

표 하단에 검색 입력칸이 있습니다.

- 글자를 입력하면 “노래 이름” 열에서 해당 글자가 포함된 행들이 하이라이트 됩니다.
- Enter를 누르면 다음 결과로 이동합니다.
- Esc를 누르면 검색 강조가 해제됩니다.

---

## 18) “음원 정보 검사” 기능 (버튼: 음원 정보 검사)

이 기능은 다음을 비교해 오류를 찾습니다:

- `음원 정보`에 있는 정보(제목/구간)
- 실제 저장 폴더(`sound/선택확장자`)에 있는 파일들

### 18-1. 검사에서 걸리는 대표 오류
- 음원 정보에는 있는데 파일이 없음 → “해당 번호의 음원 파일이 존재하지 않습니다.”
- 같은 번호 파일이 2개 이상 있음 → “같은 번호로 중복 잘린 파일 존재”
- 파일 제목과 음원 정보 제목이 다름 → “제목 불일치”
- 파일은 있는데 음원 정보가 없음 → “파일은 존재하지만 음원 정보가 비어 있습니다.”

### 18-2. 검사 중 “다시 자르기” 옵션이 뜨는 경우
일부 오류는 “이 음원만 다시 자르시겠습니까?”가 뜹니다.
- 예를 누르면:
  - 메인 창의 시작 번호/끝 번호가 해당 번호로 자동 설정되고
  - 자르기가 바로 실행됩니다.

---
